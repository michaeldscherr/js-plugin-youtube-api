{"version":3,"file":null,"sources":["../src/youtube-api.js"],"sourcesContent":["if (typeof Object.assign !== 'function') {\n    Object.assign = function(target) {\n        if (target === null) {\n            throw new TypeError('Cannot convert undefined or null to object');\n        }\n        target = Object(target);\n        for (var index = 1; index < arguments.length; index++) {\n            var source = arguments[index];\n            if (source !== null) {\n                for (var key in source) {\n                    if (Object.prototype.hasOwnProperty.call(source, key)) {\n                        target[key] = source[key];\n                    }\n                }\n            }\n        }\n        return target;\n    };\n}\n\nwindow.youtubeClient = (function(window, document) {\n\n    /*\n        * since `onYouTubeIframeAPIReady` is only called once\n        * keep track of the elements before the script is loaded\n    */\n    let initialElemsBeforeInit = [];\n\n    // defaults for plugin\n    const defaults = {\n        onAPIReady: () => {},\n        onStateChange: () => {},\n        playerVars: {\n            autoplay: 0,\n            controls: 0,\n            loop: 1,\n            modestbranding: 1,\n            showinfo: 0,\n            wmode: 'opaque'\n        }\n    };\n\n    /**\n        * youtube api that gets injected\n        * into the youtube client instance\n    */\n    const youtubeAPI = function(reference, options) {\n\n        const elem = reference.elem;\n        const videoid = reference.videoid;\n        let player = null;\n\n        // return the player\n        let getPlayer = () => player;\n\n        /**\n            * build the youtube player\n            * set variables\n            * bind the events\n        */\n        let build = function () {\n            player = new window.YT.Player(elem, {\n                videoId: videoid,\n                playerVars: options.playerVars,\n                events: {\n                    onReady: options.onAPIReady,\n                    onStateChange: (state) => options.onStateChange(state)\n                }\n            });\n        };\n\n        return {\n            build,\n            getPlayer\n        };\n    };\n\n    // set to false initially\n    let scriptLoaded = false;\n\n    /**\n        this function loads the YouTube API script\n        the script generated will trigger the\n        `window.onYouTubeIframeAPIReady` function\n    */\n    function loadAPIScript() {\n        if (scriptLoaded === true) {\n            return;\n        }\n        const firstScriptTag = document.getElementsByTagName('script')[0];\n        let tag = document.createElement('script');\n        tag.src = 'https://www.youtube.com/iframe_api';\n        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);\n    }\n\n    const YoutubeClient = function(elem, options) {\n        this.options = Object.assign({}, defaults, options);\n        this.elem = elem;\n        this.videoid = this.elem.getAttribute('data-yt-videoid');\n        this.api = new youtubeAPI(this, this.options);\n    };\n\n    /**\n        destroy the current\n        player instance\n    */\n    YoutubeClient.prototype.destroy = function() {\n        const player = this.api.getPlayer();\n        player.destroy();\n    };\n\n    /**\n        * on init, build the player\n        * from the api\n    */\n    YoutubeClient.prototype.init = function() {\n        this.api.build();\n    };\n\n    /**\n        * simple factory function to return\n        * a new `YoutubeClient` instance to\n        * each element passed in\n    */\n    const factory = function(elems, options = {}) {\n        if (!elems.length) {\n            elems = [...elems];\n        }\n        const cb = (targets) => {\n            targets.forEach((target) => {\n                if (typeof options === 'string') {\n                    if (target.YouTubeClient && typeof target.YouTubeClient[options] !== 'function') {\n                        throw new Error(`\"${options}\" method is not defined on ${target}`);\n                    }\n                    return target.YouTubeClient[options]();\n                }\n                if (target.youtubeClientInitialized === true) {\n                    return true;\n                }\n                const youtubeClient = new YoutubeClient(target, options);\n                youtubeClient.init();\n                target.youtubeClientInitialized = true;\n                target.YouTubeClient = youtubeClient;\n                return target.YouTubeClient;\n            });\n        };\n        if (scriptLoaded) {\n            cb(elems);\n            return;\n        }\n        /*\n            * push initial elements, since youtube script\n            * has not loaded yet\n        */\n        initialElemsBeforeInit.push(...elems);\n        window.onYouTubeIframeAPIReady = () => {\n            scriptLoaded = true;\n            cb(initialElemsBeforeInit);\n        };\n        loadAPIScript();\n    };\n\n    // return just the factory, everything else is private\n    return factory;\n\n})(window, document);\n\n(function(window, document) {\n\n    // check for document ready state\n    document.onreadystatechange = () => {\n        if (document.readyState === 'complete') {\n\n            // select elements, initialize plugin\n            const elems = document.querySelectorAll('[data-yt-client=\"true\"]');\n            window.youtubeClient(elems);\n\n        }\n    };\n\n})(window, document);\n"],"names":["Object","assign","target","TypeError","index","arguments","length","source","key","prototype","hasOwnProperty","call","window","youtubeClient","document","loadAPIScript","scriptLoaded","const","firstScriptTag","getElementsByTagName","tag","createElement","src","parentNode","insertBefore","let","initialElemsBeforeInit","defaults","onAPIReady","onStateChange","playerVars","autoplay","controls","loop","modestbranding","showinfo","wmode","youtubeAPI","reference","options","elem","videoid","player","getPlayer","build","YT","Player","videoId","events","onReady","state","YoutubeClient","this","getAttribute","api","destroy","init","factory","elems","cb","targets","forEach","YouTubeClient","Error","youtubeClientInitialized","push","onYouTubeIframeAPIReady","onreadystatechange","readyState","querySelectorAll"],"mappings":"AAA6B,kBAAlBA,QAAOC,SACdD,OAAOC,OAAS,SAASC,kBACrB,IAAe,OAAXA,EACA,KAAM,IAAIC,WAAU,6CAExBD,GAASF,OAAOE,EAChB,KAAK,GAAIE,GAAQ,EAAGA,EAAQC,UAAUC,OAAQF,IAAS,CACnD,GAAIG,GAASF,EAAUD,EACvB,IAAe,OAAXG,EACA,IAAK,GAAIC,KAAOD,GACRP,OAAOS,UAAUC,eAAeC,KAAKJ,EAAQC,KAC7CN,EAAOM,GAAOD,EAAOC,IAKrC,MAAON,KAIfU,OAAOC,cAAgB,SAAUD,EAAQE,GAiErC,QAASC,KACL,GAAIC,KAAiB,EAArB,CAGAC,GAAMC,GAAiBJ,EAASK,qBAAqB,UAAU,GAC3DC,EAAMN,EAASO,cAAc,SACjCD,GAAIE,IAAM,qCACVJ,EAAeK,WAAWC,aAAaJ,EAAKF,IAlEhDO,GAAIC,MAGEC,GACFC,WAAY,aACZC,cAAe,aACfC,YACIC,SAAU,EACVC,SAAU,EACVC,KAAM,EACNC,eAAgB,EAChBC,SAAU,EACVC,MAAO,WAQTC,EAAa,SAASC,EAAWC,GAEnCtB,GAAMuB,GAAOF,EAAUE,KACjBC,EAAUH,EAAUG,QACtBC,EAAS,KAGTC,EAAY,iBAAMD,IAOlBE,EAAQ,WACRF,EAAS,GAAI9B,GAAOiC,GAAGC,OAAON,GAC1BO,QAASN,EACTX,WAAYS,EAAQT,WACpBkB,QACIC,QAASV,EAAQX,WACjBC,cAAe,SAACqB,SAAUX,GAAQV,cAAcqB,OAK5D,QACIN,MAAAA,EACAD,UAAAA,IAKJ3B,GAAe,EAiBbmC,EAAgB,SAASX,EAAMD,GACjCa,KAAKb,QAAUvC,OAAOC,UAAW0B,EAAUY,GAC3Ca,KAAKZ,KAAOA,EACZY,KAAKX,QAAUW,KAAKZ,KAAKa,aAAa,mBACtCD,KAAKE,IAAM,GAAIjB,GAAWe,KAAMA,KAAKb,SAOzCY,GAAc1C,UAAU8C,QAAU,WAC9BtC,GAAMyB,GAASU,KAAKE,IAAIX,WACxBD,GAAOa,WAOXJ,EAAc1C,UAAU+C,KAAO,WAC3BJ,KAAKE,IAAIV,QAQb3B,IAAMwC,GAAU,SAASC,EAAOnB,sBACvBmB,EAAMpD,SACPoD,YAAYA,GAEhBzC,IAAM0C,GAAK,SAACC,GACRA,EAAQC,QAAQ,SAAC3D,GACb,GAAuB,gBAAZqC,GAAsB,CAC7B,GAAIrC,EAAO4D,eAA0D,kBAAlC5D,GAAO4D,cAAcvB,GACpD,KAAM,IAAIwB,OAAM,IAAIxB,gCAAqCrC,EAE7D,OAAOA,GAAO4D,cAAcvB,KAEhC,GAAIrC,EAAO8D,4BAA6B,EACpC,OAAO,CAEX/C,IAAMJ,GAAgB,GAAIsC,GAAcjD,EAAQqC,EAIhD,OAHA1B,GAAc2C,OACdtD,EAAO8D,0BAA2B,EAClC9D,EAAO4D,cAAgBjD,EAChBX,EAAO4D,gBAGtB,OAAI9C,OACA2C,GAAGD,IAOPhC,EAAuBuC,WAAKvC,EAAAgC,GAC5B9C,EAAOsD,wBAA0B,WAC7BlD,GAAe,EACf2C,EAAGjC,QAEPX,MAIJ,OAAO0C,IAER7C,OAAQE,UAEX,SAAUF,EAAQE,GAGdA,EAASqD,mBAAqB,WAC1B,GAA4B,aAAxBrD,EAASsD,WAA2B,CAGpCnD,GAAMyC,GAAQ5C,EAASuD,iBAAiB,0BACxCzD,GAAOC,cAAc6C,MAK9B9C,OAAQE"}